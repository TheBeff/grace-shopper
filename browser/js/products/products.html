<div class="container">

  <!-- create product -->
  <div class="well" ng-show='isAdmin()'>
      <form name="new-product">
          <div class="form-group">
              <input class="form-control" ng-model="newProduct.title" placeholder="product title" required/>
              <input class="form-control" ng-model="newProduct.description" type="text" placeholder="product description" />
              <input class="form-control" ng-model="newProduct.categories" placeholder="product categories" required/>
              <input class="form-control" ng-model="newProduct.price" placeholder="product price" />
              <input class="form-control" ng-model="newProduct.inventory" placeholder="product inventory quantity" />
              <input class="form-control" ng-model="newProduct.photo" placeholder="product photo url" />
          </div>
          <button class="btn btn-primary" ng-click="create()" ng-disabled="new-product.$invalid">Create Product</button>
      </form>
  </div>

  <!-- search bar -->
  <div class="row">
    <div class="form-group has-feedback">
      <input class="form-control" name="search" placeholder="Search products" style="padding: 10px 20px 9px 18px; text-align: center" ng-model="filtered" ng-change="filterProducts(filtered, 'title')">
      <i class="glyphicon glyphicon-search form-control-feedback"></i>
    </div>
    <!-- categories filter -->
    <div class="pull-right">
      Filter: <button ng-click="filterProducts(category, 'categories')" class="btn btn-default" ng-repeat="category in categories" style="margin-right: 5px">{{ category }}</button>
      <button ng-click="filterProducts('', 'categories')" class="btn btn-success">All</button>
    </div>
  </div>
  <br clear="all">

  <!-- product list -->
  <ul class="list-group"> 
    <li class="list-group-item col-sm-4" ng-repeat="product in products">
      <h3><a ui-sref='detail({id:product.id})'>{{product.title}}</a></h3>
      <img class="img-responsive" ng-src="{{product.photos}}" />
      <p>{{product.description}}</p>
      <p><strong>Categories:</strong> {{product.categories.join(',')}}</p>
      <p><strong>Reviews:</strong> {{product.reviews.length || 0 }}</p>
      <p ng-hide="!product.price"><strong>Price:</strong> ${{product.price}}</p>
      <p ng-hide="!product.inventory_qty || product.inventory_qty === 0"><strong>In stock:</strong> {{product.inventory_qty}}</p>
      <p ng-show="!product.inventory_qty || product.inventory_qty === 0" class="text-danger">Sold Out</p>
      <br clear="all">

      <div class="form-group">
        <p style="display: inline">Qty: </p>
        <select class="form-control" style="width: 25%; display: inline" ng-options="value for value in inventoryArray(product)" ng-model="quantity"></select>
        <notification ng-show="clicked"></notification>
        <button class="btn btn-primary" ng-disabled="!quantity" ng-click="addToCart(product, quantity, cart); clicked=true; quantity='' ">Add to Cart</button>
        <button ng-show='isAdmin()' class="btn btn-danger" ng-click="destroy(product)">Delete</button>
        <button ng-show='isAdmin()' class="btn btn-warning" ui-sref='detail({id:product.id})'>Update</button>
      </div>
      <br clear="all">
    </li>
  </ul>
  
</div>
